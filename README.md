Алгоритмические задачи на структуры данных с сайта CODEFORCES

**TEST B **

B. Выставка кактусов
ограничение по времени на тест1 секунда
ограничение по памяти на тест256 мегабайт
вводстандартный ввод
выводстандартный вывод

Харитон и Мелентий, гуляя по парку, зашли в павильон, в котором проходит выставка кактусов.

На выставке представлено много видов кактусов. Более того, среди них довольно много цветущих прямо сейчас, и Харитон надеется увидеть как можно больше разных видов цветущих кактусов.

Будем считать, что все кактусы занумерованы числами от 1 до n и выставлены в линию, а Харитон и Мелентий идут вдоль этой линии по направлению от первого кактуса к последнему.

Мелентий не разделяет интерес Харитона к кактусам и хотел бы уйти с выставки побыстрее. Мелентий помнит, какие виды кактусов они уже посмотрели, а также какие виды кактусов видели цветущими. В те моменты, когда оказывается, что все уже просмотренные виды кактусов они видели цветущими, он высказывает предположение, что других видов кактусов уже не встретится, и предложение закончить на этом просмотр.

Харитон же в ответ убеждает Мелентия, что надо пойти смотреть следующий кактус, он наверняка будет нового вида. Мелентий соглашается пойти смотреть следующий кактус, и если кактус оказывается уже просмотренного вида, вздыхает и думает, что он в очередной раз оказался прав. И, конечно, вновь предлагает Харитону закончить просмотр. Разумеется, если товарищи видят кактус ещё не просмотренного вида, Мелентий воздерживается от вздоха.

Небольшой дождь, стучащий по крыше павильона, способствовал усилиям Харитона по убеждению Мелентия, так что товарищи просмотрели все кактусы, представленные на выставке.

Ваша задача — определить:

сколько различных видов кактусов увидели Мелентий и Харитон;
сколько различных видов кактусов они увидели цветущими;
сколько раз Мелентий предложил Харитону закончить просмотр выставки;
сколько раз Мелентий вздохнул и подумал, что он в очередной раз оказался прав.
**Входные данные**

В первой строке содержится целое число n (1≤n≤105) — количество кактусов на выставке.

В каждой из следующих n строк содержится по одному названию кактуса и числу 0 или 1. Название кактуса — непустая последовательность строчных латинских букв длиной не более 25. Число 0 означает, что этот экземпляр кактуса не цветёт в данный момент, а число 1 означает, что этот экземпляр кактуса цветет в данный момент.

**Выходные данные**

В первой строке выведите количество различных видов кактусов, которые увидели Мелентий и Харитон.

Во второй строке выведите количество различных видов кактусов, которые они увидели цветущими.

В третьей строке выведите, сколько раз Мелентий предложил Харитону закончить просмотр выставки.

В четвёртой строке выведите, сколько раз Мелентий вздохнул и подумал, что он в очередной раз оказался прав.

Пример

**Входные данные**

17
opuntia 0
astrophytum 1
astrophytum 0
pereskia 1
opuntia 0
opuntia 1
opuntia 0
stenocactus 0
opuntia 0
stenocactus 1
mammillaria 1
opuntia 1
astrophytum 0
pelecyphora 0
mammillaria 0
ferocactus 0
astrophytum 1

**Выходные данные**

7
5
6
3

**Примечание**

Поясним приведённый пример.

Обозначим количество разных видов кактусов d, количество различных видов кактусов, которые были цветущими — f, количество предложений Мелентия завершить просмотр выставки — p, количество раз, которое Мелентий вздохнул — v.

Кактус #1 — опунция, он не цветёт. Значения переменных: d=1,f=0,p=0,v=0.

Кактус #2 — цветущий астрофитум. Значения переменных: d=2,f=1,p=0,v=0.

Кактус #3 — астрофитум, но в данный момент он не цветёт. Значения переменных: d=2,f=1,p=0,v=0.

Кактус #4 — цветущая переския. Значения переменных: d=3,f=2,p=0,v=0.

Кактус #5 — опунция, которая сейчас не цветёт. Значения переменных: d=3,f=2,p=0,v=0.

Кактус #6 — цветущая опунция. Теперь все виды кактусов, которые товарищи уже видели, они видели цветущими. Мелентий выскажет предложение завершить просмотр выставки. Значения переменных: d=3,f=3,p=1,v=0.

Кактус #7 — опунция, которая не цветёт. Значения переменных: d=3,f=3,p=2,v=1. Харитон уговорил посмотреть следующий кактус, но это опять опунция. Мелентий вздыхает и повторяет предложение завершить просмотр.

Кактус #8 — стенокактус, и он тоже не цветёт. Значения переменных: d=4,f=3,p=2,v=1. Харитон уговорил посмотреть ещё один кактус, и это оказался новый вид. Мелентий не вздыхает.

Кактус #9 — ещё одна опунция, которая не цветёт. Значения переменных: d=4,f=3,p=2,v=1.

Кактус #10 — цветущий стенокактус. Значения переменных: d=4,f=4,p=3,v=1. Поскольку на данный момент нет кактусов, которые товарищи не видели бы цветущими, Мелентий опять предлагает завершить просмотр выставки. Харитон ожидаемо не соглашается.

Кактус #11 — цветущая маммиллярия . Значения переменных: d=5,f=5,p=4,v=1. Такой кактус товарищи ещё не видели, поэтому Мелентий воздерживается от вздоха, но опять предлагает завершить просмотр выставки.

Кактус #12 — цветущая опунция. Значения переменных: d=5,f=5,p=5,v=2. Тут у Мелентия есть повод и вздохнуть, и снова предложить завершить просмотр выставки.

Кактус #13 — астрофитум, который не цветёт. Значения переменных: d=5,f=5,p=6,v=3. Мелентий полагает, что он, как обычно, прав, вздыхает, и высказывается, что пора уже уходить. Харитон, конечно, не согласен.

Кактус #14 — пелесифора, и он не цветёт. Значения переменных: d=6,f=5,p=6,v=3. Придётся Мелентию снова воздержаться от вдоха: товарищи увидели кактус, которого ещё не было на их пути.

Кактус #15 — маммиллярия, которая не цветёт. Значения переменных: d=6,f=5,p=6,v=3. Мелентий понимает, что придётся терпеть по крайней мере до того момента, пока они не встретят цветущую пелесифору.

Кактус #16 — ферокактус, и он не цветёт. Значения переменных: d=7,f=5,p=6,v=3. Товарищам вновь попался кактус, который они не видели ранее, да ещё и не цветущий.

Кактус #17 — цветущий астрофитум. Значения переменных: d=7,f=5,p=6,v=3.

Кактусы на выставке закончились, и товарищи могут, наконец, её покинуть. Правда, они так и не увидели цветущую пелесифору и ферокактус.



**TEST C **
C. Бабочки
ограничение по времени на тест2 секунды
ограничение по памяти на тест256 мегабайт
вводстандартный ввод
выводстандартный вывод
Не так давно в одном из известных зоопарков появилась новая камера, показывающая в прямом эфире жизнь бабочек. Мелентий охотно наблюдает за ними, тем более, что сейчас каждый день появляются новые бабочки.

Мелентий захотел сделать снимки экрана с бабочками разных видов. Он наблюдает за бабочками, и когда в объектив камеры попадает бабочка вида, снимков для которого он ещё не делал, Мелентий делает снимок экрана.

Поскольку Мелентий любит порядок, то, сделав снимок экрана, он даёт ему имя и помещает в нужный каталог. На это у него уходит k единиц времени. В течение этого времени он не может делать другие снимки экрана. К его сожалению, в течение этого времени в объектив камеры могут попадать бабочки других видов.

Его товарищ Харитон решил ему помочь. Товарищи договорились, что каждый раз, когда Мелентий делает снимок экрана, он сообщает об этом Харитону. Получив сообщение, Харитон начинает наблюдать за экраном.

Сообщение от Мелентия Харитон получает очень быстро, так что если Мелентий сделал снимок экрана в момент времени t, то в момент времени t+1 Харитон уже приступит к наблюдению за экраном.

Харитон знает, что Мелентий, сделав снимок экрана в момент времени t, в следующий раз посмотрит на экран в момент времени t+k. Если до наступления этого момента времени в объектив камеры попадёт бабочка (любого вида, Харитон в них не разбирается), Харитон сделает снимок экрана и сразу после этого прекратит наблюдение. Если же до наступления этого момента времени ни одна бабочка не попадёт в объектив камеры, Харитон просто прекратит наблюдение в этот момент.

Когда Мелентий закончит наблюдения, Харитон отошлёт ему все сделанные снимки экрана. Если среди них найдутся снимки видов бабочек, которых Мелентию заснять не удалось, он также даст им имена и поместит их в нужный каталог.

Ваша задача — по известным моментам появления бабочек определите:

сколько снимков различных видов бабочек окажется в каталоге Мелентия;
сколько из этих снимков сделано Харитоном;
сколько видов бабочек не удалось заснять ни Мелентию, ни Харитону.

**Входные данные**

В первой строке содержится целое число n (1≤n≤105) — количество бабочек, которые появлялись в течение времени наблюдения за камерой Мелентием.

Во второй строке содержится целое число k (2≤k≤105) — время, которое необходимо Мелентию, чтобы сохранить снимок экрана.

В каждой из следующих n строк содержится пара: название очередной бабочки bi и момент времени si, в который она появилась. Название бабочки — непустая строка из не более чем 25 строчных латинских букв. Гарантируется, что 1≤s1<s2<…<sn≤106).

**Выходные данные**

В первой строке выведите количество снимков различных видов бабочек, оказавшихся в каталоге Мелентия.

Во второй строке выведите количество снимков из каталога Мелентия, которые были сделаны Харитоном.

В третьей строке выведите количество видов бабочек, не попавших на снимки.

Пример

**Входные данные**

19
5
apaturairis 2
papiliomaackii 4
apaturairis 5
parnassiusapollo 10
apaturairis 11
chrysiridiarhipheus 13
chrysiridiarhipheus 15
apaturairis 17
haeterapiera 18
parnassiusapollo 21
apaturairis 27
teinopalpusaureus 32
chrysiridiarhipheus 38
papiliomaackii 42
limenitisarthemisastyanax 44
morphomenelaus 46
parnassiusapollo 49
morphomenelaus 52
aglaisio 55

**Выходные данные**

8
2
1

**Примечание**

Поясним приведённый пример.

Мелентий начинает наблюдение и в момент времени 2 видит бабочку apaturairis (переливница ивовая). Он делает снимок экрана и сообщает об этом Харитону.

В момент 3 Харитон приступает к наблюдению и в момент времени 4 видит бабочку papiliomaackii (парусник Маака). Он делает снимок экрана и прекращает наблюдение до следующего сообщения от Мелентия.

В момент времени 5 в объектив камеры вновь попадёт apaturairis, но ни Мелентий, ни Харитон её не пронаблюдают.

В момент времени 7 Мелентий вновь приступит к наблюдениям и в момент времени 10 ему удастся сделать снимок экрана с бабочкой parnassiusapollo (аполлон). Также он отошлёт сообщение Харитону.

В момент времени 11 Харитон приступит к наблюдению и сразу же сфотографирует бабочку apaturairis, после чего сочтёт свою миссию на данный момент выполненной и наблюдение прекратит.

В момент времени 13 в объектив камеры попадёт бабочка chrysiridiarhipheus (мадагаскарская урания), но ни Мелентий, ни Харитон её не увидят.

В момент времени 15 в объектив камеры вновь попадёт бабочка chrysiridiarhipheus (мадагаскарская урания), но теперь Мелентий сможет запечатлеть её, сделав снимок экрана. И, конечно, отошлёт сообщение Харитону.

В момент 16 Харитон приступит к наблюдению и в момент 17 сделает снимок экрана с бабочкой apaturairis.

В момент времени 18 в объектив камеры попадёт бабочка haeterapiera (фантомная бабочка), но ни один из товарищей её не пронаблюдает.

В момент времени 20 Мелентий вновь будет готов наблюдать за происходящим, и в момент времени 21 он вновь увидит бабочку parnassiusapollo. Поскольку такую бабочку он уже фотографировал в момент 10, он продолжит наблюдения.

В момент времени 27 Мелентий увидит бабочку apaturairis, но он уже фотографировал такую бабочку в момент 2.

В момент времени 32 Мелентий сделает снимок экрана с бабочкой teinopalpusaureus (тейнопальпус золотистый) и сообщит об этом Харитону.

В момент времени 33 Харитон приступит к наблюдению. Он знает, что Мелентий будет занят сохранением снимка экрана до момента 38, и что в этот момент Мелентий уже сможет фотографировать бабочку сам. Поэтому Харитон ждёт до момента 37 включительно, однако никаких бабочек не наблюдает, и прекращает наблюдения.

В момент времени 38 Мелентий вновь приступает к наблюдениям. Однако бабочку chrysiridiarhipheus он уже фотографировал.

В момент времени 42 Мелентий наблюдает бабочку papiliomaackii, делает снимок экрана и сообщает об этом Харитону.

В момент времени 43 Харитон в очередной раз приступает к наблюдениям, в момент 44 фотографирует бабочку limenitisarthemisastyanax (адмирал) и прекращает наблюдения.

В момент времени 46 появляется бабочка morphomenelaus, но ни Мелентий, ни Харитон не могут её сфотографировать.

В момент времени 47 Мелентий приступает к наблюдениям, в момент 49 появляется бабочка parnasiusapollo — но такую бабочку Мелентий уже фотографировал.

В момент времени 52 появляется бабочка morphomenelaus, и Мелентий делает снимок экрана, а также информирует об этом Харитона.

В момент времени 53 Харитон приступает к наблюдениям и в момент 55 фотографирует бабочку aglaisio (павлиний глаз).

На этом наблюдения товарищей за бабочками завершаются.

В каталоге Мелентия на данный момент имеются бабочки morphomenelaus, papiliomaackii, parnassiusapollo, chrysiridiarhipheus, teinopalpusaureus, apaturairis.

Харитон отправляет все сделанные им фотографии Мелентию. В его коллекции присутствуют фотографии бабочек papiliomaackii, limenitisarthemisastyanax, aglaisio, а также две фотографии apaturairis.

Когда Мелентий просматривает коллекцию фотографий Харитона, фотографии бабочек apaturairis и papiliomaackii он отбрасывает, поскольку сделал фотографии этих бабочек сам. А вот фотографиями limenitisarthemisastyanax и aglaisio он дополнит свой каталог.

Заметим, что единственный вид бабочек, который не удалось заснять ни Мелентию, ни Харитону, — это haeterapiera.


**TEST D **

D. Поддержание паритета
ограничение по времени на тест1 секунда
ограничение по памяти на тест256 мегабайт
вводстандартный ввод
выводстандартный вывод
Харитон и Мелентий часто проводят свободное время вместе. Когда товарищи решают, чем заняться, каждый из них высказывает своё предложение, которое характеризуется силой желания.

Ни в какой день не случается так, чтобы Харитон и Мелентий предложили одно и то же, поэтому либо Харитону, либо Мелентию приходится отказываться от своего предложения и соглашаться с предложением товарища. Тот из товарищей, который высказал предложение с большей силой желания, может более убедительно обосновать, почему надо заниматься тем, чем он предлагает.

Однако каждый из товарищей понимает, что если много раз подряд принимаются предложения кого-то одного из них, второму это не особенно нравится. Поэтому Харитон и Мелентий действуют следующим образом.

Пусть в некоторый день один из них высказал предложение с силой желания w1, а другой высказал предложение с силой желания w2. Далее, пусть в предыдущие k дней (подряд) принималось предложение того, кто высказал предложение с силой желания w1. Тогда, если w1<w2+k, автор предложения с силой желания w1 не станет убеждать своего товарища принять своё предложение, а, напротив, согласится с его предложением.

В случае равенства w1=w2+k будет принято предложение того из товарищей, у которого суммарно принято меньше предложений к этому моменту. Если же и по этому показателю товарищи равны, то принимается предложение Харитона.

Вам известны силы желаний предложений Харитона и Мелентия за n дней. Ваша задача — определить, чьи предложения принимались в каждый из дней.

Важное замечание. Рекомендуется формировать ответ в виде списка символов и собирать ответ в строку только непосредственно перед выводом.

**Входные данные**

В первой строке содержится целое число n (1≤n≤105) — количество дней, о которых известна информация о предложениях Харитона и Мелентия.

Во второй строке содержатся силы желаний предложений Харитона h1,h2,…,hn (1≤hi≤105, i=1,2,…,n), hi — сила желания предложения, высказанного Харитоном в день #i.

В третьей строке содержатся силы желаний предложений Мелентия m1,m2,…,mn (1≤mj≤105, j=1,2,…,n), mj — сила желания предложения, высказанного Мелентием в день #j.

**Выходные данные**

Выведите строку из n символов H и M. Символ H на позиции #k означает, что в день #k было принято предложение Харитона, а символ M на позиции #k означает, что в день #k было принято предложение Мелентия.

Примеры

**Входные данные**

11
3 8 5 11 4 2 5 7 5 8 8
2 4 10 10 3 3 7 4 1 6 7
**Выходные данные**

HHMHMMHHHMH

**Входные данные**

5
4 5 3 3 4
4 5 4 2 5

**Выходные данные**

HMHMH

**Примечание**

Поясним приведённые примеры.

Рассмотрим первый пример.

В день #1 сила желания Харитона 3 оказывается больше, чем сила желания Мелентия 2, поэтому будет принято предложение Харитона.

В день #2 сила желания Харитона 8 вновь оказывается больше, чем сила желания Мелентия 4. Но на сей раз нам нужно будет выполнить сравнение 8 с 4+1=5, поскольку предложения Мелентия отклонялись 1 день. Как можно видеть, и в этом случае сила желания Харитона оказывается больше, и во второй день снова принимается предложение Харитона.

В день #3 сила желания Харитона 5, напротив, уступает силе желания Мелентия 10. Так что принимается предложение Мелентия.

В день #4 сила желания Харитона 11 превосходит силу желания Мелентия 10, и принимается предложение Харитона.

В день #5 сила желания Харитона 4 должна сравниваться c 3+1=4, поскольку предложение Мелентия в предыдущий день было отклонено. Поскольку здесь получается равенство, придётся использовать дополнительный критерий. За предыдущие дни предложения Харитона принимались 3 раза, а предложения Мелентия — 1 раз. Поэтому будет принято предложение Мелентия.

В день #6 сила желания Харитона составляет 2, а сила желания Мелентия составляет 3. Однако поскольку в предыдущий день предложение Харитона не было принято, сравнивать будем 2+1=3 и 3. Также, как и в день #5, придётся применить дополнительный критерий. Предложения Харитона принимались за предыдущие дни 3 раза, а предложения Мелентия — 2 раза, так что и в этот раз будет принято предложение Мелентия.

В день #7 сила желания Харитона составляет 5, а сила желания Мелентия — 7. Предложения Харитона отклонялись уже два дня подряд, поэтому сравниваем 5+2=7 и 7. Как и в дни #5 и #6, придётся прибегнуть к дополнительному критерию. Однако теперь за все предыдущие дни предложений Харитона и предложений Мелентия было принято поровну (по 3). В этом случае должно быть принято предложение Харитона.

В день #8 сила желания Харитона составляет 7, а сила желания Мелентия — 4, сравнение 7 и 4+1=5 оказывается в пользу Харитона.

В день #9 сила желания Харитона составляет 5, а сила желания Мелентия — 1. Сравнение 5 и 1+2=3 всё равно приводит к тому, что будет принято предложение Харитона.

В день #10 сила желания Харитона составляет 8, а сила желания Мелентия — 6. Теперь сравнивать будем уже 8 и 6+3=9, и принято будет предложение Мелентия.

В день #11 сила желания Харитона составляет 8, а сила желания Мелентия — 7, так что принято будет предложение Харитона.

Рассмотрим второй пример.

В первый день сила желания у товарищей равная, но нет никакой «предыстории», так что принимается предложение Харитона.

Во второй день сила желания у товарищей вновь равная, но нужно учитывать, что в первый день предложение Мелентия не было принято, поэтому сравнивать следует 5 и 5+1=6. Так что во второй день принимается предложение Мелентия.

В третий день сила желания Харитона составляет 3, а сила желания Мелентия — 4. Однако в предыдущий день предложение Харитона не было принято, так что нужно сравнивать величины 3+1=4 и 4. Поскольку в предыдущие дни единожды было принято предложение Харитона, и единожды — Мелентия, то выбрать по этому критерию не представляется возможным. В случае такого равенства согласно условию принимается предложение Харитона.

В четвёртый день сила желания Харитона составляет 3, а сила желания Мелентия — 2. Поскольку в предыдущий день предложение Мелентия принято не было, то сравнивать нужно 3 и 2+1=3. Поскольку это вновь равные величины, сравниваем количество принятых ранее предложений Харитона (их 2) и Мелентия (1). Следовательно, будет принято предложение Мелентия.

Наконец, в пятый день сила желания Харитона составляет 4, а сила желания Мелентия — 5. В предыдущий день не было принято предложение Харитона, поэтому сравниваем 4+1=5 и 5. Поскольку видим равенство, задействуем второй показатель — но и по количеству принятых ранее предложений Харитон и Мелентий сравнялись: было принято по 2 предложения каждого. Поэтому принимается предложение Харитона.

**TEST E **

E. Школы танцев
ограничение по времени на тест2 секунды
ограничение по памяти на тест256 мегабайт
вводстандартный ввод
выводстандартный вывод
Не так давно Харитон увидел новый танец и захотел научиться его танцевать.

В районе, где живёт Харитон, есть n танцевальных школ. Сейчас все они набирают учеников, поэтому проводят бесплатные пробные занятия. Каждая школа выбрала день проведения пробного занятия так, чтобы в этот день не было занятий других школ. Во входных данных пробные занятия хронологически упорядочены.

Программы пробных занятий всех школ представляют собой набор некоторых танцевальных движений (как правило, из разных танцев). Харитон знает, какие танцевальные движения необходимо знать, чтобы танцевать заинтересовавший его танец.

Харитон решил, что обязательно будет посещать пробное занятие, если сможет изучить в ходе этого занятия не менее двух ещё неизвестных ему танцевальных движений нового танца. После этого он отметил в списке пробных занятий все, соответствующие этому критерию (разумеется, Харитон будет посещать занятия в хронологическом порядке).

Впрочем, Харитон не уверен, что таким образом ему удастся изучить все необходимые движения. Поэтому, если он не сможет изучить все необходимые движения описанным выше образом, он хотел бы знать, какое количество занятий ему придётся посетить кроме уже выбранных. Заметим, что Харитон хочет освоить новый танец как можно быстрее, поэтому при возможности изучить некоторое движение на нескольких занятиях он выберет наиболее раннее из них.

Ваша задача — определить, сможет ли Харитон изучить все движения нового танца, а также определить, каким образом он это сделает.

**Входные данные**

В первой строке содержится целое число m (2≤m≤105) — количество различных танцевальных движений в новом танце.

Во второй строке содержатся через пробел наименования этих движений. Наименование представляет собой непустую последовательность строчных латинских букв длиной не более 25. Гарантируется, что все наименования попарно различны.

В третьей строке содержится целое число n (1≤n≤105) — количество пробных занятий.

В следующих n строках содержатся описания пробных занятий. Считайте, что описания хронологически упорядочены.

Описание занятия #j состоит из целого числа dj (1≤dj≤105) — количества танцевальных движений, которые будут изучаться на пробном занятии, и наименований этих танцевальных движений. Каждое наименование представляет собой непустую последовательность строчных латинских букв длиной не более 25. Гарантируется, что все наименования в описании одного занятия попарно различны.

Также гарантируется, что суммарное количество наименований танцевальных движений в описании занятий не превосходит 2⋅105.

**Выходные данные**

В первой строке выведите целое число p, показывающее, сможет ли Харитон изучить все движения нового танца:

выведите 2, если Харитону будет достаточно посещать занятия, на которых он будет изучать не менее двух ещё неизвестных ему движений;
выведите 1, если Харитону нужно будет также посещать занятия, на которых он будет изучать по одному ещё неизвестному ему движению;
выведите 0, если Харитон не сможет изучить все движения, даже если посетит все пробные занятия.
Если p=0, более ничего выводить не нужно.

Если p=2 или p=1, вывод следует продолжить.

Во второй строке выведите количество z пробных занятий, на которых Харитон будет изучать не менее двух ещё неизвестных ему движений.

В третьей строке выведите z целых чисел — номера этих пробных занятий в порядке возрастания. Если z=0, выведите 0.

Для p=2 вывод на этом завершится. Если p=1, потребуется вывести ещё две строки.

В четвёртой строке выведите количество y пробных занятий, на которых Харитон будет изучать по одному ещё неизвестному ему движению.

В пятой строке выведите y целых чисел — номера этих пробных занятий в порядке возрастания.

Если некоторое движение Харитон может изучить на нескольких занятиях, он выбирает наиболее раннее из них.

Примеры

**Входные данные**

8
volta cortajaca whisk botafogo sidewalk fan alemana cucaracha
10
4 spotturn cortajaca openingout fan
5 lockstep botafogo fan doublereversespin progressiveshasse
4 cortajaca spotturn naturalturn alemana
3 fan botafogo alemana
2 flamencotaps cucaracha
5 appel whisk sidewalk attack volta
1 separation
6 coupdepique cortajaca volta cucaracha spotturn lockstep
2 sidewalk botafogo
5 attack spanishline volta alemana fan

**Выходные данные**

1
3
1 4 6
1
5

**Входные данные**

8
volta cortajaca whisk botafogo sidewalk fan alemana cucaracha
10
4 spotturn cortajaca openingout fan
5 lockstep botafogo fan doublereversespin progressiveshasse
4 cortajaca spotturn naturalturn alemana
3 fan botafogo alemana
2 flamencotaps cucaracha
5 appel whisk sidewalk attack flamencotaps
1 separation
6 coupdepique cortajaca volta cucaracha spotturn lockstep
2 sidewalk botafogo
5 attack spanishline volta alemana fan

**Выходные данные**

2
4
1 4 6 8

**Входные данные**

8
volta cortajaca whisk botafogo sidewalk fan alemana cucaracha
10
4 spotturn cortajaca openingout fan
5 lockstep botafogo fan doublereversespin progressiveshasse
4 cortajaca spotturn naturalturn alemana
3 fan botafogo alemana
2 flamencotaps alemana
5 appel whisk sidewalk attack volta
1 separation
6 coupdepique cortajaca volta botafogo spotturn lockstep
2 sidewalk botafogo
5 attack spanishline volta alemana fan

**Выходные данные**

0

**Примечание**

Поясним приведённые примеры.

Рассмотрим первый пример

На пробном занятии #1 Харитон может изучить два из интересующих его элементов: cortajaca и fan. Следовательно, в списке занятий оно будет отмеченным.

На пробном занятии #2 можно изучить элементы botafogo и fan, но элемент fan Харитон изучил на занятии #1. Поэтому пробное занятие #2 он отмечать не будет.

На пробном занятии #3 аналогичная картина. Из интересующих элементов предлагаются cortajaca и alemana. Однако cortajaca изучалась на занятии #1, так что и занятие #3 отмечено Харитоном не будет.

На пробном занятии #4 к изучению предлагаются элементы fan, botafogo, alemana. И хотя первый элемент Харитону известен, два других им ещё не изучены, так что занятие #4 будет им отмечено.

На пробном занятии #5 из интересующих Харитона предлагается элемент cucaracha, но он единственный, поэтому занятие #5 Харитон отмечать не станет.

На пробном занятии #6 у Харитона появляется возможность изучить элементы whisk, sidewalk, volta. Все они ещё не изучались Харитоном, и занятие #6 он, конечно, отметит.

На пробном занятии #7 элементов, которые могли бы заинтересовать Харитона, нет вовсе. Так что оно не станет отмеченным.

На пробном занятии #8 Харитон мог бы освоить элементы cortajaca, volta, cucaracha. Но первые два элемента ему уже известны, так что занятие не станет отмеченным.

На пробном занятии #9 Харитон мог бы изучить элементы sidewalk и botafogo. Но они были изучены ранее (на занятиях #6 и #4 соответственно).

На пробном занятии #10 у Харитона могла бы быть возможность изучить элементы volta, alemana, fan. Но все они уже изучены.

Таким образом, если Харитон посетит все отмеченные им занятия, он изучит 7 из 8 интересующих его танцевальных движений. Как можно видеть, не хватает элемента cucaracha. Этот элемент Харитон мог изучить на занятиях #5 и #8. Поскольку он выбирает наиболее раннее занятие, он выберет занятие #5.

Второй пример отличается от первого тем, что на занятии #6 предлагается несколько иной набор интересующих Харитона элементов. А именно, whisk и sidewalk (отсутствует volta).

Это приводит к тому, что на занятии #8 Харитон сможет изучить не один, а два новых элемента (volta и cucaracha). Занятий для изучения отдельных элементов Харитону не потребуется.

Наконец, в третьем примере Харитон не сможет найти элемент cucaracha в программах пробных занятий. Значит, и освоить этот элемент он не сможет.

**TEST G **

G. Тренажёр
ограничение по времени на тест2 секунды
ограничение по памяти на тест512 мегабайт
вводстандартный ввод
выводстандартный вывод
В скором времени Фалалею предстоит сдавать тест по иностранному языку, и он решил увеличить свой словарный запас. Для этого он использует тренажёр, и в вашем распоряжении имеются результаты тренировок Фалалея.

Тренажёр выдает Фалалею слово, а Фалалей предлагает перевод этого слова. В качестве результата сохраняется предложенное слово, а также информация о том, верный или неверный ответ дал Фалалей. Слова, предлагаемые тренажёром, могут повторяться любое количество раз.

Для каждого слова, предложенного тренажёром, Фалалей хочет узнать, какое максимальное количество слов разделяло два верных ответа подряд и какое минимальное количество слов разделяло два неверных ответа подряд. Ваша задача — выполнить эти подсчёты.

**Входные данные**

В первой строке содержится целое число n (1≤n≤2⋅105) — количество ответов Фалалея.

В каждой из следующих n строк содержится пара: слово, предложенное тренажёром, и символ «+» или «−» (без кавычек). Слово, предложенное тренажёром, — непустая последовательность строчных латинских символов длиной не более 25. Символ «+» соответствует верному ответу Фалалея, а символ «−» соответствует неверному ответу Фалалея. Символ отделён от слова одним пробелом.

**Выходные данные**

В первой строке выведите целое число m — количество различных слов, предложенных тренажёром.

Далее в каждой строке выведите собственно очередное слово, затем через пробел — максимальное количество слов, которое разделяло два верных ответа подряд по этому слову, и далее через пробел — минимальное количество слов, которое разделяло два неверных ответа подряд по этому слову.

Слова следует выводить в алфавитном (лексикографическом) порядке. Если какая-либо из величин не может быть вычислена, выведите вместо числа символы ND.

Рекомендуется внимательно изучить примеры входных и выходных данных.

Пример

**Входные данные**

17
go +
comparison -
contemporary -
go +
notify +
go +
contemporary -
comparison +
queue -
contemporary +
go +
comparison -
contemporary +
issue -
queue -
vertex +
vertex +

**Выходные данные**

7
comparison ND ND
contemporary 2 3
go 4 ND
issue ND ND
notify ND ND
queue ND 5
vertex 0 ND

**Примечание**

Поясним приведённый пример.

Слово comparison встретилось на позиции 3 с −, потом на позиции 8 с +, потом на позиции 12 снова с −. Хотя неверных ответов 2, но подряд таких нет, а верный и вовсе один, так что обе запрошенных величины не могут быть вычислены.

Слово contemporary встретилось на позиции 3 c −, затем на позиции 7 c −, затем на позиции 10 с + и, наконец, на позиции 13 c +. Обе величины определяются однозначно.

Слово go последовательно встречается с + на позициях 1, 4, 6, 11, так что максимальное количество слов, разделяющих два последовательных правильных ответа, составляет 4, а неверных ответов просто нет.

Слова issue и notify встречаются по одному разу (первое с −, второе с +), так что вычисления провести не получится.

Слово queue встречается дважды — на 6 и на 15 позициях, оба раза со знаком −, так что можем посчитать только количество слов, разделяющих два неверных ответа.

Наконец, слово vertex также встречается дважды — на 16 и на 17 позициях, оба раза со знаком +, так что количество слов, разделяющих два верных ответа, нулевое.



**TEST I **

I. Много фильмов
ограничение по времени на тест2 секунды
ограничение по памяти на тест256 мегабайт
вводстандартный ввод
выводстандартный вывод
Товарищ Евлампия Поликарп очень любит смотреть фильмы и следит за событиями в мире кино. Недавно он узнал, что популярный кинофестиваль объявил о проведении онлайн-программы (и, конечно, сразу сообщил об этом Евлампию — но об этом в следующей задаче). Пока доступна только программа первого дня, содержащая n фильмов.

Для каждого фильма в программе указаны время начала и время окончания, а также интересность (конечно, интересность с точки зрения Поликарпа, он её сам и указал). Фильмы упорядочены по времени начала, ради краткости названия фильмов мы не приводим, считаем фильмы занумерованными в порядке их упоминания в программе.

Поликарп считает, что надо посмотреть как можно больше фильмов. И он придумал хороший (как ему кажется) способ это сделать.

Поликарп действует следующим образом.

Он читает программу подряд, начиная с первого непросмотренного им фильма. Если этот фильм уже начался, Поликарп не будет его смотреть. Если же этот фильм ещё не начался, Поликарп проводит «анализ».

Пусть этот фильм имеет номер k, начинается в момент времени sk, заканчивается в момент времени fk и имеет интересность wk. Поликарп изучит интересность всех фильмов, которые начинаются в промежутке времени от sk до fk−1, и если не обнаружит ни одного более интересного (т.е. с интересностью, большей wk) фильма, то он будет смотреть этот фильм (#k).

Если же Поликарп найдёт фильм, имеющий большую интересность, то будет считать этот фильм новым кандидатом для просмотра и проведёт «анализ» уже для него.

Если Поликарп начал смотреть некоторый фильм, он досматривает его до конца.

Заметим, что если Поликарп читает программу в некоторый момент времени t, то все фильмы, начинающиеся в этот момент времени, можно считать ещё не начавшимися (т.е. Поликарп может выбирать фильм для просмотра и среди них тоже).

Чтение программы Поликарп начинает в момент времени 1.

Ваша задача — определить, сколько фильмов посмотрит Поликарп и какие это будут фильмы.

**Входные данные**

В первой строке содержится целое число n (1≤n≤3⋅105) — количество фильмов в программе первого дня кинофестиваля.

В каждой из следующих n строк содержится три целых числа sj, fj, wj (1≤sj<fj≤106, 1≤wj≤106,j=1,2,…,n), sj — время начала фильма #j, fj — время окончания этого фильма, wj — интересность этого фильма.

Гарантируется, что sj≤sj+1 для всех j=1,2,…,n−1.

**Выходные данные**

В первой строке выведите целое число m — количество фильмов, которые посмотрит Поликарп.

Во второй строке выведите m целых чисел через пробел — номера фильмов, которые посмотрит Поликарп.

Примеры


**Входные данные**

11
1 5 14
1 3 22
1 7 15
3 6 8
4 8 10
7 11 11
7 12 12
7 10 12
10 12 25
13 15 2
14 16 8

**Выходные данные**

3
2 9 11

**Входные данные**

5
10 25 15
22 32 14
25 45 12
25 35 12
35 48 12

**Выходные данные**

2
1 3

**Входные данные**

5
10 25 15
22 32 14
25 35 12
25 45 12
35 48 12

**Выходные данные**

3
1 3 5

**TEST J **


J. Кинофестиваль
ограничение по времени на тест2 секунды
ограничение по памяти на тест256 мегабайт
вводстандартный ввод
выводстандартный вывод
Евлампий не может назвать себя киноманом, но не откажется от возможности посмотреть хороший фильм. Так что когда его друг Поликарп рассказал ему про онлайн-программу популярного кинофестиваля, Евлампий решил внимательно изучить список фильмов и посмотреть те, которые покажутся ему наиболее интересными.

Пока доступна программа только первого дня кинофестиваля. Евлампий прочёл описания и отзывы обо всех фильмах и назначил каждому фильму значение интересности (конечно, с точки зрения Евлампия).

Таким образом, каждый фильм характеризуется временем начала, временем окончания и интересностью. Фильмы в программе упорядочены по времени их начала. Ради краткости мы не будем приводить названия фильмов, будем просто считать их занумерованными в порядке их упоминания в программе.

Евлампий решил, что смотреть больше двух фильмов в день не стоит. И теперь он хочет выбрать два фильма, которые будут иметь максимально возможную суммарную интересность. Конечно, он не может смотреть фильмы одновременно, поэтому время окончания первого из выбранных им фильмов должно быть не больше, чем время начала второго из выбранных им фильмов.

Если максимально возможную суммарную интересность можно получить более, чем для одной пары фильмов, Евлампий может выбрать любую пару.

Ваша задача — определить, какой может быть максимальная суммарная интересность двух фильмов и какие фильмы посмотрит Евлампий.

Заметим, что если посмотреть два фильма никак не получится, выведите в качестве максимальной суммарной интересности 0, а в качестве номеров фильмов — два числа −1 через пробел (конечно, в реальности, а не в задаче Евлампий просто посмотрит самый интересный фильм, но именно два фильма он посмотреть не сможет).

**Входные данные**

В первой строке содержится целое число n (1≤n≤3⋅105) — количество фильмов в программе первого дня кинофестиваля.

В каждой из следующих n строк содержится три целых числа sj, fj, wj (1≤sj<fj≤106, 1≤wj≤106,j=1,2,…,n), sj — время начала фильма #j, fj — время окончания этого фильма, wj — интересность этого фильма.

Гарантируется, что sj≤sj+1 для всех j=1,2,…,n−1.

**Выходные данные**

В первой строке выведите целое число — максимально возможную суммарную интересность двух фильмов, которую может получить Евлампий.

Во второй строке выведите два целых числа через пробел — номера фильмов, которые посмотрит Евлампий. Выводите номера фильмов в порядке их просмотра.

Если существует несколько вариантов ответа, выведите любой из них.

Примеры

**Входные данные**

11
1 5 14
1 3 22
1 8 25
3 6 21
4 8 20
7 11 11
7 12 28
7 10 12
10 12 25
13 15 12
14 16 18

**Выходные данные**

50
3 9

**Входные данные**

3
1 8 14
2 7 23
5 8 19

**Выходные данные**

0
-1 -1

**Примечание**

В первом примере также допустимым ответом будет пара фильмов с номерами 2 и 7.






